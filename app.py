import streamlit as st
import pandas as pd
import plotly.express as px
import unicodedata

# 1. Configura√ß√£o da P√°gina
st.set_page_config(page_title="Dashboard RH Executivo", layout="wide")
st.title("üìä Dashboard de Benef√≠cios Corporativos")

# --- CONFIGURA√á√ÉO DAS ABAS (GIDs) ---
SHEET_ID = "10lEeyQAAOaHqpUTOfdMzaHgjfBpuNIHeCRabsv43WTQ"

# Navega√ß√£o Limpa
DICIONARIO_DE_ABAS = {
    "Or√ßamento x Realizado | 2026": "1350897026",
    "Or√ßamento x Realizado | 2025": "1743422062",
    "Dashboard - 2025": "2124043219"
}

# --- BARRA LATERAL ---
st.sidebar.header("Navega√ß√£o")
aba_selecionada = st.sidebar.selectbox("Escolha a Vis√£o:", list(DICIONARIO_DE_ABAS.keys()))
gid_selecionado = DICIONARIO_DE_ABAS[aba_selecionada]

# --- FUN√á√ïES UTILIT√ÅRIAS ---
def formatar_moeda(valor):
    try:
        return f"R$ {float(valor):,.2f}".replace(",", "X").replace(".", ",").replace("X", ".")
    except:
        return valor

def remover_acentos(texto):
    try:
        nfkd = unicodedata.normalize('NFKD', str(texto))
        return "".join([c for c in nfkd if not unicodedata.combining(c)]).lower()
    except:
        return str(texto).lower()

# Mapa de meses para ordena√ß√£o
MAPA_MESES = {
    'jan': 1, 'fev': 2, 'mar': 3, 'abr': 4, 'mai': 5, 'jun': 6,
